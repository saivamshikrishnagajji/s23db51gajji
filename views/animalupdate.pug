extends layout

block content
    h1= title

    if (toShow == null)
        h2 No instance to update
    else
        - let id = toShow._id
        - let animal_type = toShow.animal_type
        - let color = toShow.color
        - let legs = toShow.legs

        div.row.mb-2
            div.mr-1.text-info ID is
            div.text-success #{id}

        - let actionid = "/resource/animal/" + id
        form#AnimalForm(class='mt-3', action=actionid, method="PUT")
            div.form-group
                label.animalAttr(for='animal_type' class='text-info') animal Type
                input#animal_type(type='text', name='animal_type', value=animal_type)
            div.form-group
                label.animalAttr(for='color' class='text-info') Color
                input#color(type='text', name='color', value=color)
            div.form-group
                label.animalAttr(for='number_of_wings' class='text-info') Legs
                input#number_of_wings(type='number', name='legs', value=legs)
            input(type="submit" value="Update")

        script.
            document.forms.AnimalForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                try {
                    // TODO: Add loading spinner or other user feedback

                    const resp = await fetch(event.target.action, {
                        method: 'PUT',
                        body: new URLSearchParams(new FormData(event.target))
                    });

                    if (!resp.ok) {
                        throw new Error('Network response was not ok');
                    }

                    // Attempt to parse the response as JSON
                    const body = await resp.json();
                    alert("Update success");
                   
                } catch (error) {
                 
                    alert("Update failed: " + error.message);

                    
                }
            });
